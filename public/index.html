<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>SOAS Class Options</title>
		<link rel='stylesheet' href='style.css' />
		<link rel="icon" href="http://www.soas.ac.uk/static/images/soas-icon-64x64.png">
	</head>
	<body id='app'>
		<div>
			<header class='app-header sec'><h1>
				<!-- <img width=146 height=57 src='http://www.soas.ac.uk/static/assets/soas-logo-100years-orig.png' alt='SOAS' /> -->
				<center>Class Options</center>
			</h1></header>

			<main class='sec'>

				<div id='selector'>
					<label class='dropdown'>
						<select id='programmes' v-model='programme' v-on:change='loadCourse'>
							<option v-for='degree in programmes' v-bind:value='degree.path'>{{degree.title}}</option>
						</select>
					</label>
					<center v-if='loadingCourse'>
						<img style='margin: 20px; width: 50px;' src='loading.gif' />
					</center>
				</div>

				<div id='course'>
					<center><h1><a href='{{course.url}}'>{{course.title}}</a></h1></center>
					<app-year
						v-ref:allclasscodes
						v-for='year, $index in course.structure'
						:index='$index'
						:year='course.structure[$index]'
						:course='course'
						:allclasscodes='allclasscodes'
					></app-year>
					<div style='clear: both'></div>
				</div>
			</main>

		</div>

<!-- -->

		<template id='app-year'>
			<div class='year'>
				<header class='year-header yrblock'>
					<span style='float: right;'>Credits: {{currentCredits}}/{{requiredCredits}}</span>
					<h2 style='float: left;'>Year {{index+1}}</h2>
					<div style='clear: both; display: table;'></div>
					<slot></slot>
				</header>
				<section class='yrblock'>

					<app-class class='selected'
						v-for="unit in classObjects | orderBy 'title'"
						v-on:click='unselect(unit)'
						:unit="unit"
					></app-class>

				</section>
				<section class='yrblock selectable-options'>
					<h3>Options</h3>

					<article v-for='group in course.structure[index].option_groups' v-if='!group.required'>
						<h4>{{group.rules}}</h4>
						<div v-if='group.options.length > 0'>

							<app-class class='selectable'
								v-for="unit in group.options | unitsFromGrp course.options | orderBy 'title'"
								v-on:click='select(unit,group)'
								:unit="unit"
							></app-class>

						</div>
					</article>

				</section>
			</div>
		</template>

		<template id='app-class'>
			<article class='selection'
				v-bind:class="{ 'required': $parent.isRequired(unit), 'chosen': $parent.isChosen(unit) }">
				<div>{{unit.title}}</div>
				<div>
					<sub style='float: left;'>{{unit.code}}</sub>
					<sub style='float: right;'>{{unit.credits}}</sub>
					<div style='clear: both'></div>
				</div>
				<sub class='prerequisites' v-bind:class="{ 'unsatisfied': !$parent.hasPrerequisites(unit) }">
					Prerequisites missing: {{unit.prerequisite_string}}
				</sub>
				<div class='description'>{{{unit.description}}}</div>
			</article>
		</template>

<!-- -->

		<script src="jquery.min.js"></script>
		<script src="vue.min.js"></script>
		<script src="lodash.min.js"></script>
		<script src="main.js"></script>
	</body>
</html>
