<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>SOAS Class Options</title>
		<link rel='stylesheet' href='style.css' />
		<link rel="icon" href="http://www.soas.ac.uk/static/images/soas-icon-64x64.png">
	</head>
	<body id='app'>
		<div>
			<header class='app-header sec'><h1>
				<!-- <img width=146 height=57 src='http://www.soas.ac.uk/static/assets/soas-logo-100years-orig.png' alt='SOAS' /> -->
				<center>Class Options</center>
			</h1></header>

			<main class='sec'>

				<div id='selector'>
					<label class='dropdown'>
						<select class='programmes' v-model='programme[0]' v-on:change='loadCourse()'>
							<option v-for='degree in programmes' v-bind:value='degreeFromPath(degree.path)'>{{degree.title}}</option>
						</select>
					</label>
					<label class='dropdown'>
						<select v-if='programme[0].combination == true'
							class='programmes' v-model='programme[1]' v-on:change='loadCourse()'>
							<option v-for="degree in programmes | filterBy true in 'combination'" v-bind:value='degreeFromPath(degree.path)'>{{degree.title}}</option>
						</select>
					</label>
					<center v-if='isLoadingCourse'>
						<img style='margin: 20px; width: 50px;' src='loading.gif' />
					</center>
				</div>

				<div id='course' v-if='!isLoadingCourse' v-bind:class='{combined: isCombinedCourse}'>
					<center>
						<h1 class='course-title'>
							<template v-if='isCombinedCourse'>{{course.meta[course.path[0]].classification}} <span v-for='subj in course.meta'><a href='{{subj.url}}'>{{subj.subject}}</a></span></template>
							<template v-if='!isCombinedCourse'>{{course.meta[course.path[0]].title}}</template>
						</h1>
					</center>
					<app-year
						v-ref:allclasscodes
						v-for='year in course.structure'
						:yearnumber='$index'
						:year='course.structure[$index]'
						:course='course'
						:allclasscodes='allclasscodes'
						:courseid='courseid'
					></app-year>
					<div style='clear: both'></div>
				</div>
			</main>

		</div>

<!-- -->

		<template id='app-year'>
			<div class='year'>
				<header class='year-header yrblock'>
					<span style='float: right;'>Credits: {{currentCredits}}/{{requiredCredits}}</span>
					<h2 style='float: left;'>Year {{yearnumber+1}}</h2>
					<div style='clear: both; display: table;'></div>
					<slot></slot>
				</header>
				<section class='yrblock'>

					<app-class class='selected'
						v-for="unit in classObjects | orderBy 'title' optionGroupOf(unit).required"
						v-on:click='unselect(unit)'
						:unit="unit"
					></app-class>
					<div class='wildcard'></div>

				</section>

				<section class='yrblock selectable-options'>
					<h3>Options</h3>

					<article v-for='group in year.option_groups' v-if='!group.required'>
						<h4>
							<span class='subject-option'>{{course.meta[group.coursePath].subject}}</span>
							<span>{{group.rules}}</span>
						</h4>
						<div v-if='group.options.length > 0'>

							<app-class class='selectable'
								v-for="unit in group.options | unitsFromGrp course.options | orderBy 'title' isChosen(unit)"
								v-on:click='select(unit,group)'
								:unit="unit"
							></app-class>
							<div class='wildcard'></div>

						</div>
					</article>

				</section>
			</div>
		</template>

		<template id='app-class'>
			<article class='selection'
				v-bind:class="{ 'required': $parent.isRequired(unit), 'chosen': $parent.isChosen(unit) }">
				<div>
					<span class='subject-option'>{{$parent.course.meta[unit.coursePath].subject}}</span>
					<span>{{unit.title}}</span>
				</div>
				<div>
					<sub style='float: left;'>{{unit.code}}</sub>
					<sub style='float: right;'>{{unit.credits}}</sub>
					<div style='clear: both'></div>
				</div>
				<sub class='prerequisites' v-bind:class="{ 'unsatisfied': !$parent.hasPrerequisites(unit) }">
					Prerequisites missing: {{unit.prerequisite_string}}
				</sub>
				<div class='description'>{{{unit.description}}}</div>
			</article>
		</template>

<!-- -->

		<script src="jquery.min.js"></script>
		<script src="vue.min.js"></script>
		<script src="lodash.min.js"></script>
		<script src="main.js"></script>
	</body>
</html>
